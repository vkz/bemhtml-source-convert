block navigation, default: applyNext(this._moreCounter = this.ctx.moreCounter);

block navigation, elem more, attrs: {
    var a = applyNext();
        a = this.extend(a, {
            onmousedown: this._moreCounter
        })
    return a;
}

block navigation, elem item, default: {

    var serviceAliases = {
            'encyc': {
                service: 'slovari'
            },
            'serp': {
                service: 'www'
            },
            // TODO: В данных допущена опечатка. Из-за нехорошей верстки, несуществующие типы сервисов вызывают ошибку и валят страницу. Чтобы этого избежать, на время тут поставлена эта заплатка
            'sloavri': {
                service: 'slovari'
            },
            'ticket': {
                service: 'avia'
            },
            'web': {
                service: 'www'
            }
        },
        currentService = serviceAliases[this.ctx.service];

    return applyCtx(this.extend(this.ctx, currentService));

}

block navigation {

    attrs: {
        role: 'navigation',
        'aria-label': BEM.I18N('navigation', 'search-also')
    }

    elem item {

        attrs: {
            var a = applyNext() || {};

            if(this.ctx.selected) {
                /* Отменяем role="listitem" для выделенного элемента,
                 * чтобы на него не переходить и не учитывать его
                 * в количестве элементов списка.
                 *
                 * aria-hidden не работает на listitem. */
                a.role = 'link';
                a['aria-hidden'] = true;
            } else {
                a.role = 'listitem';
            }

            return a;
        }

        mix: [{
            elemMods: {
                name: this.ctx.service,
                state: this.ctx.selected ? 'selected' : null
            }
        }]

        content: {
            block: 'service',
            service: this.ctx.service,
            iconMods: { self: '40' },
            name: this.ctx.name,
            mods: this.ctx.selected ? false : { hoverable: 'yes' },
            lang: this.ctx.lang,
            url: this.ctx.selected ? false : this.ctx.url,
            urlAttrs: {
                target: this.ctx.target,
                tabindex: 0 /* Opera 12 */
            },
            counter: this.ctx.counter
        }

    }

    elem region {
        attrs: {
            role: 'list'
        }
    }

    elem more {

        attrs: {
            role: 'listitem'
        }

        mix: [{ elem: 'item' }]

        content: [
            {
                elem: 'more-label',
                mix: [{
                    block: 'service',
                    mods: { hoverable: 'yes' }
                }],
                content: {
                    block: 'service',
                    elem: 'icon'
                }
            }
        ]

    }

    content: {
        return {
            elem: 'region',
            content: this.ctx.content
        };
    }
}
