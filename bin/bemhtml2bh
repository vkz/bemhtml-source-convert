#!/usr/bin/env node

// -i infile.bemhtml [default: stdin]
// -o outfil.bh.js [default: stdout]
// -v print ast, classification in edition to bh
// -h --help

require('coa').Cmd()
    .name(process.argv[1])
    .helpful()
    .opt()
        .name('verbose')
        .title('verbose')
        .short('v')
        .long('verbose')
        .flag()
        .end()
    .opt()
        .name('input').title('File to convert (default: stdin)')
        .short('i').long('input')
        .input()
        .end()
    .opt()
        .name('bemjson').title('Apply templates to this bemjson file')
        .short('j').long('json')
        .val(function(v) {return JSON.parse(require('fs').readFileSync(v, 'utf8'));})
        .end()
    .opt()
        .name('output').title('Output to file (default: stdout)')
        .short('o').long('output')
        .output()
        .end()
    .act(function(options) {
        // PIPE when reading from stdin, TTY when reading from file
        // console.log(process.binding ('tty_wrap').guessHandleType (0));
        return require('../lib/convert')
            .run(options);
    })
    .run();
